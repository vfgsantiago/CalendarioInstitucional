@model HomeAdminViewMOD
@{
    ViewData["Title"] = "Painel Administrativo";

    var dataAtual = DateTime.Now;
    var InicioMes = new DateTime(dataAtual.Year, dataAtual.Month, 1).ToString("yyyy-MM-dd");
    var fimMes = new DateTime(dataAtual.Year, dataAtual.Month, DateTime.DaysInMonth(dataAtual.Year, dataAtual.Month)).ToString("yyyy-MM-dd");
    var hoje = dataAtual.ToString("yyyy-MM-dd");
}

<div class="container-fluid py-5 px-5">
    <div class="row mb-5">
        <div class="bg-white rounded-3 px-4 py-3 shadow-sm">
            <div class="col-8">
                <h1 class="display-6 fw-semibold text-gray-dark mb-1">
                    Painel Administrativo
                </h1>
                <p class="text-muted fs-6 mb-0">
                    Visão geral e gestão do Calendário Institucional
                </p>
            </div>
        </div>
    </div>
    <div class="row g-4 mb-5">
        <div class="col-md-3">
            <a asp-action="Index" asp-controller="Evento" asp-area="Admin" class="text-decoration-none">
                <div class="kpi-card bg-primary shadow-sm">
                    <span class="kpi-label">Eventos</span>
                    <h2 class="kpi-value">@Model.QtdEventos</h2>
                    <i class="fas fa-calendar-alt kpi-icon"></i>
                </div>
            </a>
        </div>
        <div class="col-md-3">
            <a asp-action="Index" asp-controller="Categoria" asp-area="Admin" class="text-decoration-none">
                <div class="kpi-card bg-primary shadow-sm">
                    <span class="kpi-label">Categorias</span>
                    <h2 class="kpi-value">@Model.QtdCategorias</h2>
                    <i class="fas fa-tags kpi-icon"></i>
                </div>
            </a>
        </div>
        <div class="col-md-3">
            <a asp-action="Index"
               asp-controller="Evento"
               asp-area="Admin"
               asp-route-dtInicioPeriodo="@InicioMes"
               asp-route-dtFimPeriodo="@fimMes"
               class="text-decoration-none">
                <div class="kpi-card bg-primary shadow-sm">
                    <span class="kpi-label">Eventos do Mês</span>
                    <h2 class="kpi-value">@Model.QtdEventosMes</h2>
                    <i class="fas fa-calendar-week kpi-icon"></i>
                </div>
            </a>
        </div>
        <div class="col-md-3">
            <a asp-action="Index"
               asp-controller="Evento"
               asp-area="Admin"
               asp-route-dtInicioPeriodo="@hoje"
               asp-route-dtFimPeriodo="@hoje"
               class="text-decoration-none">
                <div class="kpi-card bg-primary shadow-sm">
                    <span class="kpi-label">Eventos Hoje</span>
                    <h2 class="kpi-value">@Model.QtdEventosDia</h2>
                    <i class="fas fa-sun kpi-icon"></i>
                </div>
            </a>
        </div>
    </div>
    <div class="row mb-5 py-5">
        <div class="col-12">
            <div class="section-header mb-4">
                <h5 class="fw-semibold mb-0">
                    <i class="fas fa-calendar-day me-2 text-primary"></i>
                    Eventos do Mês
                </h5>
                <span class="text-muted small">
                    Eventos ativos previstos para o mês atual
                </span>
            </div>
            @if (Model.ListaEventosMes?.Any() == true)
            {
                <div class="row g-4">
                    @foreach (var evento in Model.ListaEventosMes)
                    {
                        <div class="col-md-4 col-lg-3">
                            <a asp-action="Index"
                               asp-controller="Evento"
                               asp-area="Admin"
                               asp-route-cdEvento="@evento.CdEvento"
                               class="text-decoration-none">
                                <div class="event-card h-100 shadow">
                                    <div class="event-card-body px-3 py-3">
                                        <h6 class="fw-semibold mb-1 text-gray-dark">
                                            @evento.TxTitulo
                                        </h6>
                                        @{
                                            var dtInicio = evento.DtInicioEvento.Value.ToString("dd/MM/yyyy");
                                            var dtFim = evento.DtFimEvento.Value.ToString("dd/MM/yyyy");
                                        }
                                        @if (dtInicio != dtFim)
                                        {
                                            <small class="text-muted d-block">
                                                @evento.DtInicioEvento.Value.ToString("dd/MM/yyyy")
                                                -
                                                @evento.DtFimEvento.Value.ToString("dd/MM/yyyy")
                                            </small>
                                        }
                                        else
                                        {
                                            <small class="text-muted d-block">
                                                @dtInicio
                                            </small>
                                        }
                                        <div class="mt-3">
                                            <span class="badge badge-soft @evento.TxCor px-3 py-1">
                                                <i class="@evento.TxIcone me-2"></i>@evento.TxCategoria
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center text-muted py-5">
                    <i class="fas fa-calendar-times fa-2x mb-3"></i><br />
                    Nenhum evento cadastrado para este mês.
                </div>
            }

        </div>
    </div>
    <div class="row mb-4 pb-5">
        <div class="col-12">
            <div class="section-header mb-4">
                <h5 class="fw-semibold mb-0">
                    <i class="fas fa-chart-pie me-2 text-primary"></i>
                    Eventos por Categoria
                </h5>
                <span class="text-muted small">
                    Distribuição de eventos ativos por categoria
                </span>
            </div>
            @if (Model.EventosPorCategoria?.Any() == true)
            {
                <div class="row g-4">
                    @foreach (var categoria in Model.EventosPorCategoria)
                    {
                        <div class="col-md-3">
                            <a asp-action="Index"
                               asp-controller="Evento"
                               asp-area="Admin"
                               asp-route-cdCategoria="@categoria.CdCategoria"
                               class="text-decoration-none">
                                <div class="category-card h-100 @categoria.TxCor shadow py-2">
                                    <h3 class="fw-bold mb-1 text-white">
                                        @categoria.QtdEventos
                                    </h3>
                                    <span class="text-white">
                                        <i class="@categoria.TxIcone me-2"></i>@categoria.TxCategoria
                                    </span>
                                </div>
                            </a>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center text-muted py-5">
                    Nenhuma categoria com eventos cadastrados.
                </div>
            }
        </div>
    </div>
</div>
